\documentclass[a5paper]{article}
\usepackage[top=0.75in, bottom=0.5in, left=0.5in, right=0.5in, headheight=14pt]{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{forloop}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage{colortbl}

% Set up header with card numbering
\pagestyle{fancy}
\fancyhf{} % Clear default header/footer
\renewcommand{\headrulewidth}{0pt} % Remove header line

\newcounter{flashcard}
\newcommand{\numflashcards}{251}
\newcounter{cardnumber} % Temporary counter for correct numbering

% Increase row height
\renewcommand{\arraystretch}{1.5}

\begin{document}

% Index Page
\section*{\centering Flash Card Index}

\noindent
\begin{longtable}{|p{0.8\textwidth}|p{0.1\textwidth}|p{0.1\textwidth}|}
    \hline
    \multicolumn{1}{|c|}{\textbf{Card}} & \multicolumn{1}{c|}{\textbf{Front}} & \multicolumn{1}{c|}{\textbf{Back}} \\
    \hline
    \endfirsthead

    \hline
    \multicolumn{1}{|c|}{\textbf{Card}} & \multicolumn{1}{c|}{\textbf{Front}} & \multicolumn{1}{c|}{\textbf{Back}} \\
    \hline
    \endhead

    % Generate index rows with dynamic labels
    \forloop{flashcard}{1}{\value{flashcard} < \numflashcards}{%
        \hypertarget{index\arabic{flashcard}}{} % Label each entry in the index
        \ifodd\value{flashcard}\cellcolor{white}\else\cellcolor{gray!15}\fi
        \hyperlink{front\arabic{flashcard}}{\arabic{flashcard}} &
        {\hyperlink{front\arabic{flashcard}}{\textbf{\color{white}\fcolorbox{black}{blue!60}{Front}}}} &
        {\hyperlink{back\arabic{flashcard}}{\textbf{\color{white}\fcolorbox{black}{red!60}{Back}}}} \\
        \hline
    }
\end{longtable}

\newpage

% Generate all front sides first
\forloop{flashcard}{1}{\value{flashcard} < \numflashcards}{%
    \setcounter{cardnumber}{\value{flashcard}} % Store the correct card number
    \fancyhead[C]{\large \textbf{Card \arabic{cardnumber}}} % Use stored number

    \hypertarget{front\arabic{cardnumber}}{} % Correctly label each front card
    \begin{center}
        \begin{tikzpicture}
            \node[anchor=south west, inner sep=0] (img) at (0,0) {\includegraphics[width=\textwidth]{front.pdf}};
            \node[fill=blue!60, text=white, rounded corners=2mm, inner sep=4pt, font=\bfseries, anchor=south east]
                at (img.south east) {\hyperlink{back\arabic{cardnumber}}{Flip \textrightarrow}};
        \end{tikzpicture}
    \end{center}
    % Add "Index" button link at the bottom, pointing to the specific index entry
    \begin{center}
        \hyperlink{index\arabic{cardnumber}}{\textbf{\color{white}\fcolorbox{black}{blue}{Index Page}}}
    \end{center}
    \newpage
}

% Generate all back sides after the front cards
\forloop{flashcard}{1}{\value{flashcard} < \numflashcards}{%
    \setcounter{cardnumber}{\value{flashcard}} % Store the correct card number
    \fancyhead[C]{\large \textbf{Card \arabic{cardnumber}}} % Use stored number

    \hypertarget{back\arabic{cardnumber}}{} % Correctly label each back card
    \begin{center}
        \begin{tikzpicture}
            \node[anchor=south west, inner sep=0] (img) at (0,0) {\includegraphics[width=\textwidth]{back.pdf}};
            \node[fill=red!60, text=white, rounded corners=2mm, inner sep=4pt, font=\bfseries, anchor=south east]
                at (img.south east) {\hyperlink{front\arabic{cardnumber}}{\textrightarrow Flip}};
        \end{tikzpicture}
    \end{center}
    % Add "Index" button link at the bottom, pointing to the specific index entry
    \begin{center}
        \hyperlink{index\arabic{cardnumber}}{\textbf{\color{white}\fcolorbox{black}{blue}{Index Page}}}
    \end{center}
    \newpage
}

\end{document}
